const app = require('../app'),
    http = require('http'),
    config = require('../conf/config.json'),
    vamsModule = require('../module'),
    schedule = require('node-schedule');

app.set('port', config.this.port);

let server = http.createServer(app);

server.listen(config.this.port, async () => {
    console.log('req server start');

    schedule.scheduleJob('0 30 12 * * *', async function() {
        await vamsModule.videoModule.checkVideos();
    
        await vamsModule.requestModule.requestSRorNOTI(vamsModule.dataModule.makeSRorNOTI());
    
        await vamsModule.requestModule.requestKIDS(vamsModule.dataModule.makeKIDS());
    
        await vamsModule.requestModule.requestPOSTER(vamsModule.dataModule.makePOSTER());
    
        await vamsModule.requestModule.requestCI(vamsModule.dataModule.makeCI());
        
        console.log('req process end');    
    })

    
});
